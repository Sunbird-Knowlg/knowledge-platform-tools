import { Component, EventEmitter, Input, Output } from '@angular/core';
import { labels } from '../../labels/strings';
import { ConfirmDialogBoxComponent } from '../confirm-dialog-box/confirm-dialog-box.component';
import * as i0 from "@angular/core";
import * as i1 from "../../services/framework.service";
import * as i2 from "../../services/local-connection.service";
import * as i3 from "../../services/approval.service";
import * as i4 from "@angular/material/dialog";
import * as i5 from "@angular/common";
import * as i6 from "@angular/material/button";
import * as i7 from "@angular/material/icon";
import * as i8 from "@angular/material/checkbox";
import * as i9 from "@angular/material/menu";
export class TermCardComponent {
    constructor(frameworkService, localConnectionService, approvalService, dialog) {
        this.frameworkService = frameworkService;
        this.localConnectionService = localConnectionService;
        this.approvalService = approvalService;
        this.dialog = dialog;
        this.isApprovalRequired = false;
        this.approvalList = [];
        this.app_strings = labels;
        this.isSelected = new EventEmitter();
        this.selectedCard = new EventEmitter();
    }
    set data(value) {
        this._data = value;
        //  if(this._data)
        //    this.createTimeline(this._data[0].id)
        this._data.children.highlight = false;
    }
    get data() {
        return this._data;
    }
    ngOnInit() {
        this.isApprovalRequired = this.localConnectionService.getConfigInfo().isApprovalRequired;
        // console.log(this._data)
        this.updateApprovalStatus();
    }
    cardClicked(data, cardRef) {
        // this.data.selected = true
        if (this.frameworkService.isLastColumn(this.data.category)) {
            return;
        }
        this.isSelected.emit({ element: this.data.children, isSelected: !data.selected });
        this.frameworkService.currentSelection.next({ type: this.data.category, data: data.children, cardRef });
    }
    handleProductClick(term, event) {
        this.selectedCard.emit({ term: term, checked: event.checked });
    }
    updateApprovalStatus() {
        const id = this._data.children.identifier;
        this.approvalService.getUpdateList().subscribe((list) => {
            this.approvalList = list.map(item => item.identifier);
            if (this.approvalList) {
                if (this.approvalList.includes(id)) {
                    this._data.children.highlight = true;
                }
            }
        });
    }
    getColor(indexClass, cardRef, property, data) {
        let config = this.frameworkService.getConfig(data.category);
        if (cardRef.classList.contains('selected') && property === 'bgColor') {
            return config.color;
        }
        if (property === 'border') {
            let borderColor;
            if (cardRef.classList.contains((indexClass).toString())) {
                borderColor = "8px solid" + config.color;
            }
            return borderColor;
        }
    }
    remove(id) {
        this.dialog.open(ConfirmDialogBoxComponent, {
            data: id,
            width: '400px',
            panelClass: 'custom-dialog-container'
        });
        // this.frameworkService.isTermExistRemove(id);
    }
}
TermCardComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: TermCardComponent, deps: [{ token: i1.FrameworkService }, { token: i2.LocalConnectionService }, { token: i3.ApprovalService }, { token: i4.MatDialog }], target: i0.ɵɵFactoryTarget.Component });
TermCardComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.3.0", type: TermCardComponent, selector: "lib-term-card", inputs: { data: "data" }, outputs: { isSelected: "isSelected", selectedCard: "selectedCard" }, ngImport: i0, template: "<ng-container [ngSwitch]=\"( (data && data?.cardSubType) || 'cardMinimal')\">\n    <ng-container *ngSwitchCase=\"'standard'\" [ngTemplateOutlet]=\"cardStandard\"></ng-container>\n    <ng-container *ngSwitchCase=\"'space-saving'\" [ngTemplateOutlet]=\"cardSpaceSaving\"></ng-container>\n    <ng-container *ngSwitchDefault [ngTemplateOutlet]=\"cardMinimal\"></ng-container>\n</ng-container>\n\n<ng-template #cardMinimal>\n    <div #cardRef class=\"term-card clickable {{data.index}}\" (click)=\"cardClicked(data, cardRef)\"\n        [ngClass]=\"[data.children.selected?'selected':'', data.children.approvalStatus === 'Draft'? 'inDraft':'',\n    data.children.associationProperties?.approvalStatus === 'Draft' && isApprovalRequired && !approvalList.length || data.children.highlight && isApprovalRequired ? 'inAssociationDraft':'']\"\n        id=\"{{data.children.name}}\"\n        [ngStyle]=\"{'background-color':getColor(data.index,cardRef,'bgColor',data),'border-left': getColor(data.index,cardRef,'border',data)}\">\n        <!-- (click)=\"data.selected=!data.selected\" -->\n        <div class=\"term-card-parent\">\n            <!-- <Below element is to show id on top left of the card> -->\n            <!-- <div class=\"id\" [hidden]=\"true\">{{data.children.code}}</div> -->\n            <div class=\"term-card-content\">\n                <div class=\"card-title\">{{data.children.name}}</div>\n                <!-- <span>++{{data.children.selected}}+++</span>\n                <span>=={{data.children.status}}==</span>  -->\n                <div class=\"card-description\">{{data.children.description}} </div>\n                \n            </div>\n        </div>\n        <button mat-icon-button  (click)=\"$event.stopPropagation()\" [matMenuTriggerFor]=\"menu\" aria-label=\"Remove terms Association\">\n            <mat-icon>more_vert</mat-icon>\n          </button>\n          <mat-menu #menu=\"matMenu\" class=\"term-dropdown\">\n            <button mat-menu-item (click)=\"remove(data.children.identifier)\">\n              <mat-icon>delete</mat-icon>\n              <span>Remove</span>\n            </button>\n        </mat-menu>\n        <!-- <p>{{data.children.approvalStatus}}, {{data.children.associationProperties?.approvalStatus}}</p> -->\n        <!-- *ngIf=\"!data.isViewOnly && data.children.approvalStatus === 'Draft' && isApprovalRequired\" -->\n        <div class=\"term-card-checkbox\">\n            <mat-checkbox color=\"primary\" *ngIf=\"data.children.approvalStatus === 'Draft' && isApprovalRequired && !approvalList.length || \n            data.children.associationProperties?.approvalStatus === 'Draft' && isApprovalRequired && !approvalList.length ||\n            data.children.highlight && isApprovalRequired\" [checked]=\"data.children.highlight\" class=\"termSelection\"\n                (change)=\"handleProductClick(data.children, $event)\" (click)=\"$event.stopPropagation()\"></mat-checkbox>\n            <!-- data.children.highlight?'highlight':'' -->\n            <mat-icon color=\"primary\" class=\"approve-flag\"\n                *ngIf=\"data.children.highlight && isApprovalRequired\">{{app_strings.flag}}</mat-icon>\n        </div>\n    </div>\n</ng-template>\n\n<ng-template #cardStandard>\n    <div>\n        {{data.children.name}}\n    </div>\n    <div>\n        {{data.children.description}}\n    </div>\n</ng-template>\n\n<ng-template #cardSpaceSaving>\n    <div>\n        {{data.children.name}}\n    </div>\n</ng-template>", styles: [".term-card{border:1px solid #EEEEEE;padding:.5em;margin:0 0 1em;background-color:#fff;border-radius:8px;overflow:hidden;position:relative;z-index:45;box-shadow:#0000001a 0 1px 3px,#0000000f 0 1px 2px}.term-card .termSelection{position:absolute;right:10px;top:10px}.term-card .term-card-parent{display:flex;width:90%}.term-card .term-card-parent .term-card-content{white-space:initial;position:relative;margin-left:.5em}.term-card .term-card-parent .term-card-content .card-title{margin-bottom:.5em}.term-card .term-card-parent .term-card-content .card-description{opacity:.5}.term-card .term-card-checkbox{width:10%}.term-card .mat-menu-trigger{position:absolute;top:0;right:0;z-index:1000}.term-card.selected{color:#fff;border-style:none}.clickable{cursor:pointer}.approve-flag{position:absolute;right:5px;top:35px;font-size:24px}.mat-menu-item{width:200px}::ng-deep .cdk-overlay-pane:has(.mat-menu-panel.term-dropdown){width:200px}.mat-menu-panel .term-dropdown{padding:10px 0}::ng-deep .custom-dialog-container .mat-dialog-container{background:#fff;padding:20px}\n"], dependencies: [{ kind: "directive", type: i5.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i5.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: i5.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "directive", type: i5.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { kind: "directive", type: i5.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { kind: "directive", type: i5.NgSwitchDefault, selector: "[ngSwitchDefault]" }, { kind: "component", type: i6.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }, { kind: "component", type: i7.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "component", type: i8.MatCheckbox, selector: "mat-checkbox", inputs: ["disableRipple", "color", "tabIndex"], exportAs: ["matCheckbox"] }, { kind: "component", type: i9.MatMenu, selector: "mat-menu", exportAs: ["matMenu"] }, { kind: "component", type: i9.MatMenuItem, selector: "[mat-menu-item]", inputs: ["disabled", "disableRipple", "role"], exportAs: ["matMenuItem"] }, { kind: "directive", type: i9.MatMenuTrigger, selector: "[mat-menu-trigger-for], [matMenuTriggerFor]", exportAs: ["matMenuTrigger"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: TermCardComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lib-term-card', template: "<ng-container [ngSwitch]=\"( (data && data?.cardSubType) || 'cardMinimal')\">\n    <ng-container *ngSwitchCase=\"'standard'\" [ngTemplateOutlet]=\"cardStandard\"></ng-container>\n    <ng-container *ngSwitchCase=\"'space-saving'\" [ngTemplateOutlet]=\"cardSpaceSaving\"></ng-container>\n    <ng-container *ngSwitchDefault [ngTemplateOutlet]=\"cardMinimal\"></ng-container>\n</ng-container>\n\n<ng-template #cardMinimal>\n    <div #cardRef class=\"term-card clickable {{data.index}}\" (click)=\"cardClicked(data, cardRef)\"\n        [ngClass]=\"[data.children.selected?'selected':'', data.children.approvalStatus === 'Draft'? 'inDraft':'',\n    data.children.associationProperties?.approvalStatus === 'Draft' && isApprovalRequired && !approvalList.length || data.children.highlight && isApprovalRequired ? 'inAssociationDraft':'']\"\n        id=\"{{data.children.name}}\"\n        [ngStyle]=\"{'background-color':getColor(data.index,cardRef,'bgColor',data),'border-left': getColor(data.index,cardRef,'border',data)}\">\n        <!-- (click)=\"data.selected=!data.selected\" -->\n        <div class=\"term-card-parent\">\n            <!-- <Below element is to show id on top left of the card> -->\n            <!-- <div class=\"id\" [hidden]=\"true\">{{data.children.code}}</div> -->\n            <div class=\"term-card-content\">\n                <div class=\"card-title\">{{data.children.name}}</div>\n                <!-- <span>++{{data.children.selected}}+++</span>\n                <span>=={{data.children.status}}==</span>  -->\n                <div class=\"card-description\">{{data.children.description}} </div>\n                \n            </div>\n        </div>\n        <button mat-icon-button  (click)=\"$event.stopPropagation()\" [matMenuTriggerFor]=\"menu\" aria-label=\"Remove terms Association\">\n            <mat-icon>more_vert</mat-icon>\n          </button>\n          <mat-menu #menu=\"matMenu\" class=\"term-dropdown\">\n            <button mat-menu-item (click)=\"remove(data.children.identifier)\">\n              <mat-icon>delete</mat-icon>\n              <span>Remove</span>\n            </button>\n        </mat-menu>\n        <!-- <p>{{data.children.approvalStatus}}, {{data.children.associationProperties?.approvalStatus}}</p> -->\n        <!-- *ngIf=\"!data.isViewOnly && data.children.approvalStatus === 'Draft' && isApprovalRequired\" -->\n        <div class=\"term-card-checkbox\">\n            <mat-checkbox color=\"primary\" *ngIf=\"data.children.approvalStatus === 'Draft' && isApprovalRequired && !approvalList.length || \n            data.children.associationProperties?.approvalStatus === 'Draft' && isApprovalRequired && !approvalList.length ||\n            data.children.highlight && isApprovalRequired\" [checked]=\"data.children.highlight\" class=\"termSelection\"\n                (change)=\"handleProductClick(data.children, $event)\" (click)=\"$event.stopPropagation()\"></mat-checkbox>\n            <!-- data.children.highlight?'highlight':'' -->\n            <mat-icon color=\"primary\" class=\"approve-flag\"\n                *ngIf=\"data.children.highlight && isApprovalRequired\">{{app_strings.flag}}</mat-icon>\n        </div>\n    </div>\n</ng-template>\n\n<ng-template #cardStandard>\n    <div>\n        {{data.children.name}}\n    </div>\n    <div>\n        {{data.children.description}}\n    </div>\n</ng-template>\n\n<ng-template #cardSpaceSaving>\n    <div>\n        {{data.children.name}}\n    </div>\n</ng-template>", styles: [".term-card{border:1px solid #EEEEEE;padding:.5em;margin:0 0 1em;background-color:#fff;border-radius:8px;overflow:hidden;position:relative;z-index:45;box-shadow:#0000001a 0 1px 3px,#0000000f 0 1px 2px}.term-card .termSelection{position:absolute;right:10px;top:10px}.term-card .term-card-parent{display:flex;width:90%}.term-card .term-card-parent .term-card-content{white-space:initial;position:relative;margin-left:.5em}.term-card .term-card-parent .term-card-content .card-title{margin-bottom:.5em}.term-card .term-card-parent .term-card-content .card-description{opacity:.5}.term-card .term-card-checkbox{width:10%}.term-card .mat-menu-trigger{position:absolute;top:0;right:0;z-index:1000}.term-card.selected{color:#fff;border-style:none}.clickable{cursor:pointer}.approve-flag{position:absolute;right:5px;top:35px;font-size:24px}.mat-menu-item{width:200px}::ng-deep .cdk-overlay-pane:has(.mat-menu-panel.term-dropdown){width:200px}.mat-menu-panel .term-dropdown{padding:10px 0}::ng-deep .custom-dialog-container .mat-dialog-container{background:#fff;padding:20px}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.FrameworkService }, { type: i2.LocalConnectionService }, { type: i3.ApprovalService }, { type: i4.MatDialog }]; }, propDecorators: { data: [{
                type: Input
            }], isSelected: [{
                type: Output
            }], selectedCard: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVybS1jYXJkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3NiLXRheG9ub215LWVkaXRvci9zcmMvbGliL2NvbXBvbmVudHMvdGVybS1jYXJkL3Rlcm0tY2FyZC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zYi10YXhvbm9teS1lZGl0b3Ivc3JjL2xpYi9jb21wb25lbnRzL3Rlcm0tY2FyZC90ZXJtLWNhcmQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBZ0IsTUFBTSxlQUFlLENBQUE7QUFLNUYsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRzlDLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLG9EQUFvRCxDQUFBOzs7Ozs7Ozs7OztBQU05RixNQUFNLE9BQU8saUJBQWlCO0lBcUI1QixZQUFvQixnQkFBa0MsRUFDNUMsc0JBQThDLEVBQzlDLGVBQWdDLEVBQ2pDLE1BQWlCO1FBSE4scUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUM1QywyQkFBc0IsR0FBdEIsc0JBQXNCLENBQXdCO1FBQzlDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUNqQyxXQUFNLEdBQU4sTUFBTSxDQUFXO1FBcEIxQix1QkFBa0IsR0FBWSxLQUFLLENBQUE7UUFDbkMsaUJBQVksR0FBZ0IsRUFBRSxDQUFDO1FBQy9CLGdCQUFXLEdBQVEsTUFBTSxDQUFDO1FBWWhCLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBaUIsQ0FBQTtRQUM5QyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFlLENBQUE7SUFLMUIsQ0FBQztJQWpCL0IsSUFDSSxJQUFJLENBQUMsS0FBVTtRQUNqQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNu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QUU7WUFDMUMsSUFBSSxFQUFDLEVBQUU7WUFDUCxLQUFLLEVBQUUsT0FBTztZQUNkLFVBQVUsRUFBRSx5QkFBeUI7U0FDdEMsQ0FBQyxDQUFDO1FBQ0wsK0NBQStDO0lBQ25ELENBQUM7OzhHQTlFVSxpQkFBaUI7a0dBQWpCLGlCQUFpQixvSkNkOUIsbzVHQTREYzsyRkQ5Q0QsaUJBQWlCO2tCQUw3QixTQUFTOytCQUNFLGVBQWU7a01BWXJCLElBQUk7c0JBRFAsS0FBSztnQkFXSSxVQUFVO3NCQUFuQixNQUFNO2dCQUNHLFlBQVk7c0JBQXJCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBTaW1wbGVDaGFuZ2UgfSBmcm9tICdAYW5ndWxhci9jb3JlJ1xuaW1wb3J0IHsgTlNGcmFtZXdvcmsgfSBmcm9tICcuLi8uLi9tb2RlbHMvZnJhbWV3b3JrLm1vZGVsJ1xuaW1wb3J0IHsgQXBwcm92YWxTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvYXBwcm92YWwuc2VydmljZSc7XG5pbXBvcnQgeyBGcmFtZXdvcmtTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZnJhbWV3b3JrLnNlcnZpY2UnXG5pbXBvcnQgeyBMb2NhbENvbm5lY3Rpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvbG9jYWwtY29ubmVjdGlvbi5zZXJ2aWNlJztcbmltcG9ydCB7IGxhYmVscyB9IGZyb20gJy4uLy4uL2xhYmVscy9zdHJpbmdzJztcbmltcG9ydCB7IENhcmRTZWxlY3Rpb24sIENhcmRDaGVja2VkLCBDYXJkIH0gZnJvbSAnLi4vLi4vbW9kZWxzL3ZhcmlhYmxlLXR5cGUubW9kZWwnO1xuaW1wb3J0IHsgTWF0RGlhbG9nUmVmLCBNQVRfRElBTE9HX0RBVEEsIE1hdERpYWxvZyB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQgeyBDb25maXJtRGlhbG9nQm94Q29tcG9uZW50IH0gZnJvbSAnLi4vY29uZmlybS1kaWFsb2ctYm94L2NvbmZpcm0tZGlhbG9nLWJveC5jb21wb25lbnQnXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdsaWItdGVybS1jYXJkJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3Rlcm0tY2FyZC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3Rlcm0tY2FyZC5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFRlcm1DYXJkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgLy8gQElucHV0KCkgZGF0YSE6IE5TRnJhbWV3b3JrLklUZXJtQ2FyZFxuXG4gIHByaXZhdGUgX2RhdGE6IE5TRnJhbWV3b3JrLklUZXJtQ2FyZDtcbiAgaXNBcHByb3ZhbFJlcXVpcmVkOiBib29sZWFuID0gZmFsc2VcbiAgYXBwcm92YWxMaXN0OiBBcnJheTxDYXJkPiA9IFtdO1xuICBhcHBfc3RyaW5nczogYW55ID0gbGFiZWxzO1xuICBASW5wdXQoKVxuICBzZXQgZGF0YSh2YWx1ZTogYW55KSB7XG4gICAgdGhpcy5fZGF0YSA9IHZhbHVlO1xuICAgIC8vICBpZih0aGlzLl9kYXRhKVxuICAgIC8vICAgIHRoaXMuY3JlYXRlVGltZWxpbmUodGhpcy5fZGF0YVswXS5pZClcbiAgICB0aGlzLl9kYXRhLmNoaWxkcmVuLmhpZ2hsaWdodD1mYWxzZVxuICB9XG4gIGdldCBkYXRhKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gIH1cblxuICBAT3V0cHV0KCkgaXNTZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXI8Q2FyZFNlbGVjdGlvbj4oKVxuICBAT3V0cHV0KCkgc2VsZWN0ZWRDYXJkID0gbmV3IEV2ZW50RW1pdHRlcjxDYXJkQ2hlY2tlZD4oKVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZnJhbWV3b3JrU2VydmljZTogRnJhbWV3b3JrU2VydmljZSwgXG4gICAgcHJpdmF0ZSBsb2NhbENvbm5lY3Rpb25TZXJ2aWNlOiBMb2NhbENvbm5lY3Rpb25TZXJ2aWNlLCBcbiAgICBwcml2YXRlIGFwcHJvdmFsU2VydmljZTogQXBwcm92YWxTZXJ2aWNlLFxuICAgIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZykgeyB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5pc0FwcHJvdmFsUmVxdWlyZWQgPSB0aGlzLmxvY2FsQ29ubmVjdGlvblNlcnZpY2UuZ2V0Q29uZmlnSW5mbygpLmlzQXBwcm92YWxSZXF1aXJlZFxuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuX2RhdGEpXG4gICAgdGhpcy51cGRhdGVBcHByb3ZhbFN0YXR1cygpXG4gIH1cblxuICBjYXJkQ2xpY2tlZChkYXRhOiBhbnksIGNhcmRSZWY6IGFueSkge1xuICAgIC8vIHRoaXMuZGF0YS5zZWxlY3RlZCA9IHRydWVcbiAgICBpZih0aGlzLmZyYW1ld29ya1NlcnZpY2UuaXNMYXN0Q29sdW1uKHRoaXMuZGF0YS5jYXRlZ29yeSkpe1xuICAgICAgcmV0dXJuIFxuICAgIH1cbiAgICB0aGlzLmlzU2VsZWN0ZWQuZW1pdCh7IGVsZW1lbnQ6IHRoaXMuZGF0YS5jaGlsZHJlbiwgaXNTZWxlY3RlZDogIWRhdGEuc2VsZWN0ZWQgfSlcbiAgICB0aGlzLmZyYW1ld29ya1NlcnZpY2UuY3VycmVudFNlbGVjdGlvbi5uZXh0KHsgdHlwZTogdGhpcy5kYXRhLmNhdGVnb3J5LCBkYXRhOiBkYXRhLmNoaWxkcmVuLCBjYXJkUmVmIH0pXG4gIH1cblxuICBoYW5kbGVQcm9kdWN0Q2xpY2sodGVybSwgZXZlbnQpe1xuICAgIHRoaXMuc2VsZWN0ZWRDYXJkLmVtaXQoe3Rlcm06dGVybSwgY2hlY2tlZDpldmVudC5jaGVja2VkfSlcbiAgfVxuXG4gIHVwZGF0ZUFwcHJvdmFsU3RhdHVzKCl7XG4gICAgIGNvbnN0IGlkID0gdGhpcy5fZGF0YS5jaGlsZHJlbi5pZGVudGlmaWVyO1xuICAgIHRoaXMuYXBwcm92YWxTZXJ2aWNlLmdldFVwZGF0ZUxpc3QoKS5zdWJzY3JpYmUoKGxpc3Q6YW55KSA9PiB7XG4gICAgICB0aGlzLmFwcHJvdmFsTGlzdCA9IGxpc3QubWFwKGl0ZW0gPT4gaXRlbS5pZGVudGlmaWVyKTtcbiAgICAgIGlmKHRoaXMuYXBwcm92YWxMaXN0KXtcbiAgICAgICAgICAgaWYodGhpcy5hcHByb3ZhbExpc3QuaW5jbHVkZXMoaWQpKXtcbiAgICAgICAgICAgICAgdGhpcy5fZGF0YS5jaGlsZHJlbi5oaWdobGlnaHQgPSB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICB9ICAgICBcbiAgICB9KVxuICB9XG5cbiAgZ2V0Q29sb3IoaW5kZXhDbGFzczpudW1iZXIsIGNhcmRSZWY6IGFueSxwcm9wZXJ0eTogc3RyaW5nLCBkYXRhOmFueSkge1xuICAgIGxldCBjb25maWcgPSB0aGlzLmZyYW1ld29ya1NlcnZpY2UuZ2V0Q29uZmlnKGRhdGEuY2F0ZWdvcnkpO1xuICAgIGlmKGNhcmRSZWYuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpICYmIHByb3BlcnR5ID09PSAnYmdDb2xvcicpe1xuICAgICAgIHJldHVybiBjb25maWcuY29sb3I7XG4gICAgfVxuICAgIGlmKHByb3BlcnR5ID09PSAnYm9yZGVyJyl7XG4gICAgICBsZXQgYm9yZGVyQ29sb3I7XG4gICAgICBpZihjYXJkUmVmLmNsYXNzTGlzdC5jb250YWlucygoaW5kZXhDbGFzcykudG9TdHJpbmcoKSkpe1xuICAgICAgICBib3JkZXJDb2xvciA9IFwiOHB4IHNvbGlkXCIgKyBjb25maWcuY29sb3I7XG4gICAgICB9XG4gICAgICByZXR1cm4gYm9yZGVyQ29sb3I7XG4gICAgfVxuICB9XG4gIFxuICByZW1vdmUoaWQpe1xuICAgICAgICB0aGlzLmRpYWxvZy5vcGVuKENvbmZpcm1EaWFsb2dCb3hDb21wb25lbnQsIHtcbiAgICAgICAgICBkYXRhOmlkLFxuICAgICAgICAgIHdpZHRoOiAnNDAwcHgnLFxuICAgICAgICAgIHBhbmVsQ2xhc3M6ICdjdXN0b20tZGlhbG9nLWNvbnRhaW5lcidcbiAgICAgICAgfSk7XG4gICAgICAvLyB0aGlzLmZyYW1ld29ya1NlcnZpY2UuaXNUZXJtRXhpc3RSZW1vdmUoaWQpO1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyIFtuZ1N3aXRjaF09XCIoIChkYXRhICYmIGRhdGE/LmNhcmRTdWJUeXBlKSB8fCAnY2FyZE1pbmltYWwnKVwiPlxuICAgIDxuZy1jb250YWluZXIgKm5nU3dpdGNoQ2FzZT1cIidzdGFuZGFyZCdcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJjYXJkU3RhbmRhcmRcIj48L25nLWNvbnRhaW5lcj5cbiAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaENhc2U9XCInc3BhY2Utc2F2aW5nJ1wiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImNhcmRTcGFjZVNhdmluZ1wiPjwvbmctY29udGFpbmVyPlxuICAgIDxuZy1jb250YWluZXIgKm5nU3dpdGNoRGVmYXVsdCBbbmdUZW1wbGF0ZU91dGxldF09XCJjYXJkTWluaW1hbFwiPjwvbmctY29udGFpbmVyPlxuPC9uZy1jb250YWluZXI+XG5cbjxuZy10ZW1wbGF0ZSAjY2FyZE1pbmltYWw+XG4gICAgPGRpdiAjY2FyZFJlZiBjbGFzcz1cInRlcm0tY2FyZCBjbGlja2FibGUge3tkYXRhLmluZGV4fX1cIiAoY2xpY2spPVwiY2FyZENsaWNrZWQoZGF0YSwgY2FyZFJlZilcIlxuICAgICAgICBbbmdDbGFzc109XCJbZGF0YS5jaGlsZHJlbi5zZWxlY3RlZD8nc2VsZWN0ZWQnOicnLCBkYXRhLmNoaWxkcmVuLmFwcHJvdmFsU3RhdHVzID09PSAnRHJhZnQnPyAnaW5EcmFmdCc6JycsXG4gICAgZGF0YS5jaGlsZHJlbi5hc3NvY2lhdGlvblByb3BlcnRpZXM/LmFwcHJvdmFsU3RhdHVzID09PSAnRHJhZnQnICYmIGlzQXBwcm92YWxSZXF1aXJlZCAmJiAhYXBwcm92YWxMaXN0Lmxlbmd0aCB8fCBkYXRhLmNoaWxkcmVuLmhpZ2hsaWdodCAmJiBpc0FwcHJvdmFsUmVxdWlyZWQgPyAnaW5Bc3NvY2lhdGlvbkRyYWZ0JzonJ11cIlxuICAgICAgICBpZD1cInt7ZGF0YS5jaGlsZHJlbi5uYW1lfX1cIlxuICAgICAgICBbbmdTdHlsZV09XCJ7J2JhY2tncm91bmQtY29sb3InOmdldENvbG9yKGRhdGEuaW5kZXgsY2FyZFJlZiwnYmdDb2xvcicsZGF0YSksJ2JvcmRlci1sZWZ0JzogZ2V0Q29sb3IoZGF0YS5pbmRleCxjYXJkUmVmLCdib3JkZXInLGRhdGEpfVwiPlxuICAgICAgICA8IS0tIChjbGljayk9XCJkYXRhLnNlbGVjdGVkPSFkYXRhLnNlbGVjdGVkXCIgLS0+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXJtLWNhcmQtcGFyZW50XCI+XG4gICAgICAgICAgICA8IS0tIDxCZWxvdyBlbGVtZW50IGlzIHRvIHNob3cgaWQgb24gdG9wIGxlZnQgb2YgdGhlIGNhcmQ+IC0tPlxuICAgICAgICAgICAgPCEtLSA8ZGl2IGNsYXNzPVwiaWRcIiBbaGlkZGVuXT1cInRydWVcIj57e2RhdGEuY2hpbGRyZW4uY29kZX19PC9kaXY+IC0tPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRlcm0tY2FyZC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtdGl0bGVcIj57e2RhdGEuY2hpbGRyZW4ubmFtZX19PC9kaXY+XG4gICAgICAgICAgICAgICAgPCEtLSA8c3Bhbj4rK3t7ZGF0YS5jaGlsZHJlbi5zZWxlY3RlZH19KysrPC9zcGFuPlxuICAgICAgICAgICAgICAgIDxzcGFuPj09e3tkYXRhLmNoaWxkcmVuLnN0YXR1c319PT08L3NwYW4+ICAtLT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZC1kZXNjcmlwdGlvblwiPnt7ZGF0YS5jaGlsZHJlbi5kZXNjcmlwdGlvbn19IDwvZGl2PlxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8YnV0dG9uIG1hdC1pY29uLWJ1dHRvbiAgKGNsaWNrKT1cIiRldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiIFttYXRNZW51VHJpZ2dlckZvcl09XCJtZW51XCIgYXJpYS1sYWJlbD1cIlJlbW92ZSB0ZXJtcyBBc3NvY2lhdGlvblwiPlxuICAgICAgICAgICAgPG1hdC1pY29uPm1vcmVfdmVydDwvbWF0LWljb24+XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPG1hdC1tZW51ICNtZW51PVwibWF0TWVudVwiIGNsYXNzPVwidGVybS1kcm9wZG93blwiPlxuICAgICAgICAgICAgPGJ1dHRvbiBtYXQtbWVudS1pdGVtIChjbGljayk9XCJyZW1vdmUoZGF0YS5jaGlsZHJlbi5pZGVudGlmaWVyKVwiPlxuICAgICAgICAgICAgICA8bWF0LWljb24+ZGVsZXRlPC9tYXQtaWNvbj5cbiAgICAgICAgICAgICAgPHNwYW4+UmVtb3ZlPC9zcGFuPlxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvbWF0LW1lbnU+XG4gICAgICAgIDwhLS0gPHA+e3tkYXRhLmNoaWxkcmVuLmFwcHJvdmFsU3RhdHVzfX0sIHt7ZGF0YS5jaGlsZHJlbi5hc3NvY2lhdGlvblByb3BlcnRpZXM/LmFwcHJvdmFsU3RhdHVzfX08L3A+IC0tPlxuICAgICAgICA8IS0tICpuZ0lmPVwiIWRhdGEuaXNWaWV3T25seSAmJiBkYXRhLmNoaWxkcmVuLmFwcHJvdmFsU3RhdHVzID09PSAnRHJhZnQnICYmIGlzQXBwcm92YWxSZXF1aXJlZFwiIC0tPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGVybS1jYXJkLWNoZWNrYm94XCI+XG4gICAgICAgICAgICA8bWF0LWNoZWNrYm94IGNvbG9yPVwicHJpbWFyeVwiICpuZ0lmPVwiZGF0YS5jaGlsZHJlbi5hcHByb3ZhbFN0YXR1cyA9PT0gJ0RyYWZ0JyAmJiBpc0FwcHJvdmFsUmVxdWlyZWQgJiYgIWFwcHJvdmFsTGlzdC5sZW5ndGggfHwgXG4gICAgICAgICAgICBkYXRhLmNoaWxkcmVuLmFzc29jaWF0aW9uUHJvcGVydGllcz8uYXBwcm92YWxTdGF0dXMgPT09ICdEcmFmdCcgJiYgaXNBcHByb3ZhbFJlcXVpcmVkICYmICFhcHByb3ZhbExpc3QubGVuZ3RoIHx8XG4gICAgICAgICAgICBkYXRhLmNoaWxkcmVuLmhpZ2hsaWdodCAmJiBpc0FwcHJvdmFsUmVxdWlyZWRcIiBbY2hlY2tlZF09XCJkYXRhLmNoaWxkcmVuLmhpZ2hsaWdodFwiIGNsYXNzPVwidGVybVNlbGVjdGlvblwiXG4gICAgICAgICAgICAgICAgKGNoYW5nZSk9XCJoYW5kbGVQcm9kdWN0Q2xpY2soZGF0YS5jaGlsZHJlbiwgJGV2ZW50KVwiIChjbGljayk9XCIkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcIj48L21hdC1jaGVja2JveD5cbiAgICAgICAgICAgIDwhLS0gZGF0YS5jaGlsZHJlbi5oaWdobGlnaHQ/J2hpZ2hsaWdodCc6JycgLS0+XG4gICAgICAgICAgICA8bWF0LWljb24gY29sb3I9XCJwcmltYXJ5XCIgY2xhc3M9XCJhcHByb3ZlLWZsYWdcIlxuICAgICAgICAgICAgICAgICpuZ0lmPVwiZGF0YS5jaGlsZHJlbi5oaWdobGlnaHQgJiYgaXNBcHByb3ZhbFJlcXVpcmVkXCI+e3thcHBfc3RyaW5ncy5mbGFnfX08L21hdC1pY29uPlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbjxuZy10ZW1wbGF0ZSAjY2FyZFN0YW5kYXJkPlxuICAgIDxkaXY+XG4gICAgICAgIHt7ZGF0YS5jaGlsZHJlbi5uYW1lfX1cbiAgICA8L2Rpdj5cbiAgICA8ZGl2PlxuICAgICAgICB7e2RhdGEuY2hpbGRyZW4uZGVzY3JpcHRpb259fVxuICAgIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNjYXJkU3BhY2VTYXZpbmc+XG4gICAgPGRpdj5cbiAgICAgICAge3tkYXRhLmNoaWxkcmVuLm5hbWV9fVxuICAgIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT4iXX0=